<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Puppet-iptables : Puppet module to manage iptables allow and deny rules" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Puppet-iptables</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/erwbgy/puppet-iptables">View on GitHub</a>

          <h1 id="project_title">Puppet-iptables</h1>
          <h2 id="project_tagline">Puppet module to manage iptables allow and deny rules</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/erwbgy/puppet-iptables/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/erwbgy/puppet-iptables/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>puppet-iptables</h1>

<p>Manage iptables incoming rules</p>

<p>The recommended usage is to place the configuration under an iptables hash in
hiera and just include the iptables module in your puppet configuration:</p>

<pre><code>include iptables
</code></pre>

<p>Example hiera config:</p>

<pre><code>iptables::allow_icmp: 'yes'
iptables::allow_localhost: 'yes'
iptables::log_failures: 'yes'
iptables::ports:
  22:
    tcp: 'allow'
  80:
    tcp: 'allow'
  23:
    tcp: 'drop'
    udp: 'drop'
</code></pre>

<p>This example configures iptables to allow incoming TCP connections to ports 22
(ssh) and 80 (http), and silently drop all connections to port 23 (telnet).
All ICMP and localhost connections will be allowed and failed connections to
other ports will be logged to syslog.</p>

<p>Notes:</p>

<ul>
<li><p>The default policy is to deny all connections and log failures to syslog
(usually /var/log/messages).</p></li>
<li><p>To allow connections to a particular port add an allow rule like that for
port 80 above.</p></li>
<li><p>To avoid denied connections to a particular port being logged add a drop rule
like that for port 23 above.</p></li>
<li><p>To avoid any failed connections being logged set the log_failures parameter
to 'no'.</p></li>
<li><p>By default all ICMP traffic is allowed.  Set allow_icmp to 'no' to change
this.</p></li>
<li><p>By default all localhost traffic is allowed.  Set allow_localhost to 'no' to
change this.</p></li>
<li><p>If no iptables configuration is found then an allow rule is added for tcp/22
(ssh) like the default iptables configuration.</p></li>
<li><p>If there is both an allow rule and a drop rule for a port and protocol then
access is allowed.</p></li>
</ul><h2>Parameters</h2>

<ul>
<li><p><em>logfailures</em>: whether or not to log failed connections that are not explicitly dropped. Possible values: 'yes' or 'no'. Default: 'yes'</p></li>
<li><p><em>allow_icmp</em>: whether or not to allow all ICMP traffic. Possible values: 'yes' or 'no'. Default: 'yes'</p></li>
<li><p><em>allow_localhost</em>: whether or not to allow all localhost (127.0.0.0/8) traffic. Possible values: 'yes' or 'no'. Default: 'yes'</p></li>
<li>
<p><em>ports</em> hash:</p>

<ul>
<li>
<em></em> hash: the port number to add a rule for (eg. 22)

<ul>
<li>'tcp': Possible values are 'allow' or 'drop'.</li>
<li>'udp': Possible values are 'allow' or 'drop'.</li>
</ul>
</li>
</ul>
</li>
</ul><h2>Implementation</h2>

<p>The iptables::allow and iptables::drop resources create files under
/root/iptables.d with a filename including the action (allow or drop), the
protocol (tcp or udp) and the port number.  Creating these files triggers an
update script that combines all the entries together into a new
/etc/sysconfig/iptables file and restarts the iptables service.</p>

<p>The iptables::clean class removes all files under /root/iptables.d.</p>

<h2>iptables::allow</h2>

<p>Allow access to the specified port.</p>

<p><em>port</em>: the incoming port number. Required.</p>

<p><em>protocol</em>: either 'tcp' or 'udp'. Required.</p>

<p>Example:</p>

<pre><code>iptables::allow { 'tcp/22': port =&gt; '22', protocol =&gt; 'tcp' }
</code></pre>

<h2>iptables::drop</h2>

<p>Deny access to the specified port without logging.</p>

<p><em>port</em>: the incoming port number. Required.</p>

<p><em>protocol</em>: either 'tcp' or 'udp'. Required.</p>

<p>Example:</p>

<pre><code>iptables::drop { 'tcp/21': port =&gt; '21', protocol =&gt; 'tcp' }
</code></pre>

<h2>iptables::clean</h2>

<p>Remove all files under /root/iptables.d.  This has the effect of starting with
a clean configuration and is required if you want to remove rules for ports
defined previously.</p>

<p>To use just temporarily:</p>

<pre><code>include iptables::clean
</code></pre>

<p>in a host configuration.</p>

<h2>Support</h2>

<p>License: Apache License, Version 2.0</p>

<p>GitHub URL: <a href="https://github.com/erwbgy/puppet-iptables">https://github.com/erwbgy/puppet-iptables</a></p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Puppet-iptables maintained by <a href="https://github.com/erwbgy">erwbgy</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
